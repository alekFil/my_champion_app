# Прогнозирование качества исполнения элементов фигурного катания

* **Обобщенный блокнот-отчет о работе:** [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/alekFil/my_champion_app/blob/main/notebooks/my_champion_app.ipynb)

* **Демонстрация приложения**: [My Champion App](https://my-champion-app.streamlit.app/)
 <img src="images\my-champion-app.streamlit.app.gif" alt="covers">


## Описание работы

**Цель работы:**
Построить и обучить модели машинного обучения (МО), позволяющие предсказать элементы фигурного катания, которые может выполнить спортсмен.

**Планируемое использование результата работы:**
Заказчику необходимо приобрести инструмент, который поможет тренеру оперативно оценить возможности и перспективы спортсмена. Кроме того, возможно использование инструмента в оценке риска получения спортсменов травм в результате совершения ошибок при исполнении элементов фигурного катания.

**Входные данные:**
Заказчик предоставил набор данных о выступлениях спортсменов на различных соревнованиях за 3 года с указанием выполненных элементов, допущенных ошибок и результатах выступлений.

## Инструменты
- **Scikit-learn**: Для создания и обучения модели.
- **PyTorch, transformers**: Для применения минимальных техник NLP в анализе элементов фигурного катания.
- **Pandas**, **Matplotlib**, **Seaborn**: Для анализа данных и визуализации.
- **Streamlit**: Для разработки и развёртывания интерактивного веб-приложения.

## Основные этапы и результаты
- **Изучение данных, предобработка, feature engineering:** В условиях ограниченности времени работы над задачей проведен быстрый исследовательский анализ данных, совмещенный с их предобработкой. Созданы новые признаки, характеризующие спортсменов на основании истории их выступлений.

- **Описание разрабатываемых моделей:** 
  
  На основании интерпретации задачи, представленной выше, принято решение о реализации четырех моделей машинного обучения:
  - *Модель № 1* для предсказания вероятности идеального исполнения элементов. Решена задача бинарной классификации (1 - идеальное исполнение, 0 - исполнение с ошибками) с определением вероятности отнесения экземпляра к одному из классов. Предсказания модели используются в работе следующей модели. Для учета качества предсказания класса 0 выбрана метрика **F1_Weighted**. Результат моделирования **F1 = 0.84**.
  - *Модель № 2* для предсказания количества очков, которые спортсмен может получить за выполнение элемента (идеальное или с ошибками) - GOE. Решена задача регрессии. Предсказания модели используются в работе следующей модели и расчете общей суммы очков за исполнение элемента. Для анализа моделей регрессии выбрана метрика RMSE, отражающая среднюю ошибку предсказания в единицах измерения таргета. Результат моделирования **RMSE = 0.57** для оценок GOE в диапазоне [-5,5].
  - *Модель № 3* для предсказания вероятности возникновения ошибок. Решена задача мульти-лейбл классификации для 7 ошибок ("q", "e", "!", "<", "<<", "V"; для прогнозирования иных ошибок, например, nS, nU и др. определено, что не достаточно данных) с определением вероятности присвоения меток классам. Для анализа моделей мульти-лейбл классификации выбрана метрика **Hamming Loss**, отражающая долю меток, которые были предсказаны неправильно. 
  - *Модель № 4* (планируется к реализации, эксперименты не показали качественных результатов) для предсказания элементов фигурного катания, которые могут быть исполнены идеально и принести равное или большее количество очков.

- **Проверка моделей на тестовых данных:** 
  Планируется провести оценку качество моделей на эмпирических тестовых данных. Изучить ошибки моделей. Последний этап не завершен ввиду ограниченности времени.

## Выводы 
1. Модель предсказания вероятности идеального исполнения элементов показывает достаточно высокую точность для исследуемого набора данных. Целесообразно расширить набор данных дополнительными наблюдения, и, важнее всего, дополнительными признаками. Например, признаками, определяющими опыт (уровень) спортстмена. Целесообразно внимательно изучить ошибки модели и интерпретировать их. Усложнять модель не планируется, так как важно сохранение возможности интерпретации результатов её работы.
2. Для модели предсказания GOE целесообразно уточнить метрики для оценки (например, MAPE) и применить иные алгоритмы (бустинги). Сохранение интерпретируемости модели важно для заказчка (тренеров), необходимо обратить на это внимание. Планируется провести генерацию новых признаков и отбор наиболее важных (после дополнения набора данных).
3. Для модели предсказания вероятности ошибок целесообразно применить ансамблирование и смешивание результатов. Интерпретируемость модели сохранить сложно, более важно повысить точность предсказания. Работа модели наиболее важна для предсказания вероятности травм и, как следствие, риска наступления страхового случая. Предлагается применение методов соревновательного DS для максимизации точности модели за счет снижения интерпретируемости.

## Дальнейшая работа
1. **Улучшение моделей**:
   - Продолжить эксперименты с моделями № 1, № 2 для улучшения качества предсказаний.
   - Внедрить дополнительные метрики для более детальной оценки качества моделей, такие как Precision, Recall, и ROC-AUC для классификационных моделей и MAE для регрессионных моделей.
   - Рассмотреть возможность использования ансамблей и смешивания результатов для модели № 3 для максимизации точности предсказаний.
2. **Расширение набора данных**:
   - Пополнить набор данных дополнительной информацией, такой как данные о тренировках спортсменов, физическом состоянии и других параметрах, которые могут влиять на выполнение элементов.
3. **Разработка новой модели для рекомендации выполнения элементов**:
   - Продолжить исследование возможности использования моделей для рекомендации элементов, которые может выполнить спортсмен.
   - Разработать Модель № 4.
4. **Разработка новой модели для оценки риска травм**:
   - Исследовать возможность использования моделей для предсказания риска получения травм на основании анализа ошибок и их частоты.
   - Разработать Модель № 5.
5. **Документирование**:
   - Создать детальную документацию для каждой модели, описывающую их архитектуру, метрики, использованные данные и результаты.
   - Подготовить руководство по интеграции моделей в существующую инфраструктуру.
6. **Валидация и тестирование**:
   - Провести стресс-тестирование моделей на различных наборах данных для оценки их устойчивости и производительности.
   - Подготовить тестовые сценарии для оценки моделей в условиях, приближенных к реальным.
7. **Разработка API**:
   - Разработать API для взаимодействия с моделями. API должно включать методы для предсказания, обновления данных и получения метрик.
8. **Развертывание моделей**:
   - Использовать контейнеризацию (например, Docker) для упаковки моделей и их зависимостей.
   - Развернуть контейнеры на серверах или в облаке (например, AWS, GCP, Azure) для обеспечения доступности и масштабируемости.
9. **Интеграция с веб-приложением**:
   - Интегрировать модели с интерактивным веб-приложением, разработанным на Streamlit.
   - Обеспечить удобный интерфейс для взаимодействия тренеров с моделями в повседневной работе: удобного использования предсказаний моделей тренерами.
10. **Мониторинг и поддержка**:
    - Внедрить системы мониторинга (например, Prometheus, Grafana) для отслеживания производительности моделей и API.
    - Настроить сбор метрик работы сервиса, таких как время отклика, частота использования, точность предсказаний, и т.д.
    - Внедрить систему логирования для отслеживания запросов и ответов API, а также ошибок и исключений. Использовать централизованные решения для управления логами (например, ELK Stack).
    - Настроить алерты для уведомления о сбоях в работе моделей или снижении их производительности. Обеспечить уведомления ответственным специалистам через средства коммуникации.
    - Организовать процесс регулярного обновления данных и дообучения моделей. Внедрить системы автоматического перезапуска моделей на новых данных.
11. **Регулярные обзоры и улучшения**:
    - Проводить регулярные обзоры работы моделей и их результатов.
    - Вносить улучшения на основе отзывов пользователей и новых данных.

## Запуск проекта
Чтобы развернуть проект необходимо:
1. Клонировать репозиторий:
`git clone https://github.com/alekFil/my_champion_app.git`
2. Установить зависимости: `pip install -r requirements.txt`

Запуск Streamlit приложения: 
```bash
streamlit run app.py
```

## Запуск ноутбуков
Чтобы запустить ноутбуки необходимо установить иные зависимости:
1. Клонировать репозиторий:
`git clone https://github.com/alekFil/my_champion_app.git`
2. Установить зависимости для ноутбуков: `pip install -r requirements-notebooks.txt`

## Контакты
Автор проекта - Алексей Филатов: [telegram @alekFil](https://t.me/alekfil).
